!function(){var a=function(a){return this.Storage={isCompatible:function(){return"undefined"!=typeof Storage},put:function(a){if("undefined"==typeof a.key||"undefined"==typeof a.value)throw new Error("Invalid arguments: "+a);localStorage.setItem(a.key,JSON.stringify(a.value))},get:function(a){if("string"!=typeof a)throw new Error('The storage key must be a string. (Got "'+a+'")');return localStorage[a]},clear:function(){localStorage.clear()}},this};Allspeak=function(b){"undefined"==typeof b&&(b={});var c=new a,d=null;this.debug=b.debug||!1,this.path=b.path||"./translations",this.defaultDomain=b.defaultDomain||"messages",this.keyAttrName=b.keyAttrName||"data-key",this.domainAttrName=b.domainAttrName||"data-domain",this.raw=b.raw||!1,this.useCache="boolean"==typeof b.useCache?b.useCache:c.Storage.isCompatible(),c.Storage.isCompatible()||console.warn("Your browser is't compatible with localStorage. The cache mode has been disabled.");var e=function(a,b,c){c="boolean"==typeof c?c:!0;var d;d=window.XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP"),d.onreadystatechange=function(){if(4===d.readyState){if(200===d.status){var a=JSON.parse(d.responseText);return b&&b(a),a}return console.warn('An error occurred while loading the translation data: "'+d.responseText+'"'),!1}},d.open("GET",a,c),d.send()},f=function(a,b){if(this.debug&&console.info("Updating element:",a),this.raw)a.innerHTML=b;else{var c=document.createElement("div");c.appendChild(document.createTextNode(b)),a.innerHTML=c.innerHTML}},g=function(a,b){for(var c=b.scope.getElementsByTagName("*"),d=c.length-1;d>=0;d--){var e=c[d],g=e.getAttribute(a.keyAttrName);if("undefined"==typeof g)return;if("undefined"==typeof b.data[g])return void console.warn('Unknow translation key "'+g+'", domain "'+b.domain+'"');a.debug&&console.info('Translating from loaded JSON: ["'+g+'", "'+b.locale+'"]');var h=b.data[g][b.locale];if("undefined"==typeof h)return void console.warn('Missing translation for ["'+g+'", "'+b.locale+'"], domain "'+b.domain+'"');f.bind(a)(e,h)}b.scope.lang=b.locale};return this.trans=function(a){var b,h=this.defaultDomain,i=document.documentElement,j=this;"string"==typeof a?b=a:(b=a.locale,h=a.domain||this.defaultDomain,i=a.scope||document.documentElement);var k=this.path+"/"+h+".json";if(i.lang===b)return this;if(this.useCache){for(var l=i.getElementsByTagName("*"),m=l.length-1;m>=0;m--){var n=l[m],o=n.getAttribute(j.keyAttrName);if("undefined"!=typeof o&&null!==o){j.debug&&console.info('Translating from storage cache: ["'+o+'", "'+b+'"]');var p=c.Storage.get(o);if(p)p=JSON.parse(c.Storage.get(o))[b];else if(j.debug&&console.info('Key "'+o+'" missing from storage. Updating from cached JSON'),null===d)j.debug&&console.info("No cached JSON data was found."),e(k,function(a){return"undefined"==typeof a[o]?void console.warn('Unknow translation key "'+o+'", domain "'+h+'"'):(p=a[o][b],"undefined"==typeof p?void console.warn('Missing translation for ["'+o+'", "'+b+'"], domain "'+h+'"'):(j.debug&&console.info('Caching the translations for "'+o+'" into storage'),c.Storage.put({key:o,value:a[o]}),void(d=a)))},!1);else{if("undefined"==typeof d[o])return void console.warn('Unknow translation key "'+o+'"');if(p=d[o][b],"undefined"==typeof p)return void console.warn('Missing translation for "'+o+", "+b+'"');j.debug&&console.info('Caching the translations for "'+o+'" into storage'),c.Storage.put({key:o,value:d[o]})}f.bind(j)(n,p)}}i.lang=b}else e(k,function(a){g(j,{scope:i,locale:b,data:a,domain:h})});return this},this.clearCache=function(){return this.debug&&console.info("Clearing translation cache"),d=null,c.Storage.clear(),this},this}}();